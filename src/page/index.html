<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{title}}</title>

    {{{style}}}
</head>

<body>

    <header>
        <div class="headerContent">
            <h1>{{title}}</h1>
        </div>
    </header>

    <div class="mainContent">
        <nav>
            <ul></ul>
        </nav>

        <main>
            <md-block id="pageContent"></md-block>
        </main>

    </div>

    <div id="contentJson" style="display: none;">{{content}}</div>

    <script>
        const pages = JSON.parse(document.getElementById('contentJson').textContent);

        const buildNavBar = (pages, parent = null) => {
            const navBar = document.querySelector('nav ul');

            const entries = Object.keys(pages);
            const sortedEntries = entries.sort((a, b) => {
                return pages[a].order - pages[b].order;
            });



            sortedEntries.forEach(key => {
                const page = pages[key];

                if (page.isPage) {
                    const li = document.createElement('li');
                    li.classList.add('navBarItem');
                    if (parent !== null) li.classList.add('subNavBarItem');
                    li.textContent = page.title;
                    li.setAttribute('content', page.content);
                    navBar.appendChild(li);
                } else {
                    const submenuHeader = document.createElement('li');
                    submenuHeader.classList.add('submenuHeader');
                    submenuHeader.classList.add('navBarItem');
                    submenuHeader.textContent = page.title;
                    navBar.appendChild(submenuHeader);
                    buildNavBar(page.entries, submenuHeader);

                }
            });
        }
        buildNavBar(pages);

        const setSelectedNavItem = (item) => {
            const selectedItem = document.querySelector('.navBarItemSelected');
            if (selectedItem) selectedItem.classList.remove('navBarItemSelected');
            item.classList.add('navBarItemSelected');

            const newContent = item.getAttribute('content');
            if (newContent == null) return;

            const pageContent = document.getElementById('pageContent');
            pageContent.innerHTML = newContent;
        }

        const pageContent = document.getElementById('pageContent');
        const navBarItems = document.querySelectorAll('.navBarItem');
        navBarItems.forEach(item => {
            item.addEventListener('click', () => {
                setSelectedNavItem(item);
            });
        });

        navBarItems[0].click();

    </script>

</body>

</html>